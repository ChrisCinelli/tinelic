<!DOCTYPE html>
<html lang="en">
<head>
{#_t_env_production}
<script src="{_t_prefix}/js/build/rum.js"></script>
{:else}
<script src="{_t_prefix}/app/rum.js"></script>
{/_t_env_production}
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="{_t_prefix}/css/style.css" rel="stylesheet">
<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="//cdn.ravenjs.com/1.1.15/jquery,native/raven.min.js"></script>
<script>
(function () {
	var _t_page = new Date();
	Tinelic.config({url:location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '')+"/collect/browser/{_t_self_id}",
		route:"{_t_route}",
		_dtp:_t_page
	})
	Raven.config(location.protocol + '//nah@' + location.hostname + (location.port ? ':' + location.port : '')+'/collect/sentry/{_t_self_id}', {
		dataCallback: function(data) {
			data._dtp = _t_page;
			data._dt = new Date();
			return data;
		}
	}).install();
})();
</script>
</head>
<body id="content">
{@view name=_t_main_view /}

{#_t_env_production}
<script src="{_t_prefix}/js/build/require.js"></script>
<script src="{_t_prefix}/js/build/app.js"></script>
<script src="{_t_prefix}/js/build/routes/main.js"></script>
{:else}
<script src="{_t_prefix}/app/require.js"></script>
{/_t_env_production}

<script>
	requirejs.config({
		baseUrl: "{_t_prefix}/app",
		paths:{
			"tinybone":"../tinybone",
			"lodash":"../js/lodash",
			"dust":"../js/dust",
			"dust-helpers":"../js/dust-helpers",
			"safe":"../js/safe",
			"bootstrap":"../js/bootstrap",
			"highcharts":location.protocol+"//code.highcharts.com/highcharts",
			"moment":"../js/moment",
			"dustc":"../tinybone/dustc",
			"text":"../js/text",
		},
		shim: {
			'dust': {
				exports: 'dust'
			},
			'dust-helpers': {
				exports: 'helpers'
			}
		}
	})
	define("backctx","/restapi/");

	$.getJSON("/web/app/wire/{_t_unique}", function (wire) {
		requirejs(["app"], function (App) { (new App()).init(wire); })
	})
	// error simulation
	var _t_page = new Date();
	setTimeout(function () {
		if (_t_page.valueOf()%2)
			throw new Error("Test Error"+(new Date()).getDay());
	},1000);
	if (_t_page.valueOf()%2)
		throw new Error("Test Error1"+(new Date()).getDay());
</script>
</body>
</html>
